<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Display Data</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.16.13/antd.min.css">
</head>
<body>
    <div id="root"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/antd/4.16.13/antd.min.js"></script>
    <script>
        const { useState, useEffect } = React;
        const { Input, Button, Row, Col, Card } = antd;

        const App = () => {
            const [modelsData, setModelsData] = useState({});
            const [searchInput, setSearchInput] = useState('');

            useEffect(() => {
                const timestamp = new Date().getTime();
                fetch(`output/data.json?t=${timestamp}`, { cache: 'no-store' })
                    .then(response => response.json())
                    .then(data => {
                        console.log('Fetched data:', data);
                        setModelsData(data);
                    })
                    .catch(error => console.error('Error fetching data:', error));
            }, []);

            const displayModels = (data) => {
                return Object.entries(data).map(([key, modelData], index) => {
                    if (key !== 'end') {
                        console.log(modelData)
                        // return (
                        //     <Col span={8} key={key}>
                        //         <Card title={`Model: ${modelData.content.model.name}`} bordered={false}>
                        //             <p>Path: {modelData.path}</p>
                        //             <p>Created Time: {modelData.created_time.split('.')[0]}</p>
                        //             <pre>{JSON.stringify(modelData.content, null, 2)}</pre>
                        //         </Card>
                        //     </Col>
                        );
                    }
                    return null;
                });
            };

            const filterModels = () => {
                const filteredData = {};
                for (const [key, modelData] of Object.entries(modelsData)) {
                    if (modelData === "end") continue;
                    if (modelData.content.model.name.toLowerCase().includes(searchInput.toLowerCase())) {
                        filteredData[key] = modelData;
                    }
                }
                return filteredData;
            };

            const clearSearch = () => {
                setSearchInput('');
            };

            return (
                <div>
                    // <div>All Models</div>
                    // <div id="searchContainer">
                    //     <Input
                    //         type="text"
                    //         value={searchInput}
                    //         placeholder="Search by Model Name"
                    //         onChange={(e) => setSearchInput(e.target.value)}
                    //         style={{ width: '200px', marginRight: '10px' }}
                    //     />
                    //     <Button onClick={clearSearch}>Clear All</Button>
                    // </div>
                    <Row gutter={[16, 16]}>
                        {displayModels(filterModels())}
                    </Row>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
